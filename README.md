# **Mixes** - repository of mixture models

This repository was created as part of Research paper "Estimation of Gaussian Mixture Networks"
required as part of Master of Mathematics degree in Computational Mathematics at the University of Waterloo authored
by Andriy Dmytruk and supervised by Ryan Browne.

The repository includes implementation of the following mixture models:
* Gaussian Mixture Model ([GMM](mixes/GMM.py))
* Skew Gaussian Mixture Model ([Skew GMM](mixes/SkewGMM.py))
* Deep Gaussian Misture Modle ([DGMM](mixes/DGMM.py))
* Gaussian Mixture Network ([GMN](mixes/GMN.py))

## Usage

The implementation is present in the [mixes/](mixes/) folder.
You can see an example of usage in the [experiments/example.ipynb](experiments/example.ipynb) jupyter notebook.

All the experiments that were performed as part of the research paper can also be found inside the [experiments/](experiments/) folder.

## Models description

### Skew Gaussian Mixture Model

Skew GMM was implemented based on paper 
["Maximum likelihood estimation for multivariate skew normal mixture models"](https://www.sciencedirect.com/science/article/pii/S0047259X08001152)
by Tsung I. Lin (2006).

### Gaussian Mixture Network

GMN was proposed in the author's research paper. The model creates a network of gaussian distributions
where next layers in the model have conditional probability distribution based on the previous layer.
Each layer is a mixture of components, therefore the whole model creates a network of gaussian nodes.

The network is visualized in the following image:
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg   xmlns:dc="http://purl.org/dc/elements/1.1/"   xmlns:cc="http://creativecommons.org/ns#"   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"   xmlns:svg="http://www.w3.org/2000/svg"   xmlns="http://www.w3.org/2000/svg"   viewBox="0 0 345.96133 178.63733"   height="178.63733"   width="345.96133"   xml:space="preserve"   id="svg2"   version="1.1"><metadata     id="metadata8"><rdf:RDF><cc:Work         rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type           rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs     id="defs6" /><g     transform="matrix(1.3333333,0,0,-1.3333333,0,178.63733)"     id="g10"><g       transform="translate(90.167,33.009)"       id="g12"><g         id="g14"><g           id="g16"><g             id="g18"><g               transform="translate(-86.846,32.942)"               id="g20"><g                 id="g22"><g                   transform="translate(-3.321,-65.951)"                   id="g24"><text                     id="text28"                     style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMSY10;-inkscape-font-specification:CMSY10;writing-mode:lr-tb;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none"                     transform="matrix(1,0,0,-1,3.321,65.951)"><tspan                       id="tspan26"                       y="0"                       x="0">N</tspan></text><text                     id="text32"                     style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMR10;-inkscape-font-specification:CMR10;writing-mode:lr-tb;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none"                     transform="matrix(1,0,0,-1,12.963,65.951)"><tspan                       id="tspan30"                       y="0"                       x="0 3.8744552">(0</tspan></text><text                     id="text36"                     style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMMI10;-inkscape-font-specification:CMMI10;writing-mode:lr-tb;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none"                     transform="matrix(1,0,0,-1,21.819,65.951)"><tspan                       id="tspan34"                       y="0"                       x="0 4.4313645">,I</tspan></text><text                     id="text40"                     style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMR10;-inkscape-font-specification:CMR10;writing-mode:lr-tb;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none"                     transform="matrix(1,0,0,-1,31.408,65.951)"><tspan                       id="tspan38"                       y="0"                       x="0">)</tspan></text><g                     transform="translate(3.321,65.951)"                     id="g42" /></g></g><g                 transform="translate(86.846,-32.942)"                 id="g44" /></g></g><g             id="g46"><g               id="g48"><g                 id="g50"><path                   id="path52"                   style="fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:#ffffff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                   d="m 6.97394,17.71672 c 0,3.85165 -3.1223,6.97394 -6.97394,6.97394 -3.85164,0 -6.97394,-3.12229 -6.97394,-6.97394 0,-3.85164 3.1223,-6.97394 6.97394,-6.97394 3.85164,0 6.97394,3.1223 6.97394,6.97394 z" /></g><g                 transform="translate(0,17.716)"                 id="g54"><g                   id="g56" /><g                   transform="translate(0,-17.716)"                   id="g58" /></g></g><g               id="g60"><g                 id="g62"><path                   id="path64"                   style="fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:#ffffff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                   d="m 6.97394,53.15024 c 0,3.85165 -3.1223,6.97394 -6.97394,6.97394 -3.85164,0 -6.97394,-3.12229 -6.97394,-6.97394 0,-3.85164 3.1223,-6.97394 6.97394,-6.97394 3.85164,0 6.97394,3.1223 6.97394,6.97394 z" /></g><g                 transform="translate(0,53.149)"                 id="g66"><g                   id="g68" /><g                   transform="translate(0,-53.149)"                   id="g70" /></g></g><g               id="g72"><g                 id="g74"><path                   id="path76"                   style="fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:#ffffff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                   d="m 77.84094,0 c 0,3.85164 -3.12228,6.97394 -6.97394,6.97394 -3.85163,0 -6.97393,-3.1223 -6.97393,-6.97394 0,-3.85164 3.1223,-6.97394 6.97393,-6.97394 3.85166,0 6.97394,3.1223 6.97394,6.97394 z" /></g><g                 transform="translate(70.866)"                 id="g78"><g                   id="g80" /><g                   transform="translate(-70.866)"                   id="g82" /></g></g><g               id="g84"><g                 id="g86"><path                   id="path88"                   style="fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:#ffffff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                   d="m 77.84094,35.43349 c 0,3.85165 -3.12228,6.97393 -6.97394,6.97393 -3.85163,0 -6.97393,-3.12228 -6.97393,-6.97393 0,-3.85164 3.1223,-6.97394 6.97393,-6.97394 3.85166,0 6.97394,3.1223 6.97394,6.97394 z" /></g><g                 transform="translate(70.866,35.433)"                 id="g90"><g                   id="g92" /><g                   transform="translate(-70.866,-35.433)"                   id="g94" /></g></g><g               id="g96"><g                 id="g98"><path                   id="path100"                   style="fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:#ffffff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                   d="m 77.84094,70.867 c 0,3.85166 -3.12228,6.97394 -6.97394,6.97394 -3.85163,0 -6.97393,-3.12228 -6.97393,-6.97394 0,-3.85163 3.1223,-6.97393 6.97393,-6.97393 3.85166,0 6.97394,3.1223 6.97394,6.97393 z" /></g><g                 transform="translate(70.866,70.866)"                 id="g102"><g                   id="g104" /><g                   transform="translate(-70.866,-70.866)"                   id="g106" /></g></g><g               id="g108"><g                 id="g110"><path                   id="path112"                   style="fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:#ffffff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                   d="m 148.70798,0 c 0,3.85164 -3.12228,6.97394 -6.97394,6.97394 -3.85165,0 -6.97394,-3.1223 -6.97394,-6.97394 0,-3.85164 3.12229,-6.97394 6.97394,-6.97394 3.85166,0 6.97394,3.1223 6.97394,6.97394 z" /></g><g                 transform="translate(141.732)"                 id="g114"><g                   id="g116" /><g                   transform="translate(-141.732)"                   id="g118" /></g></g><g               id="g120"><g                 id="g122"><path                   id="path124"                   style="fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:#ffffff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                   d="m 148.70798,35.43349 c 0,3.85165 -3.12228,6.97393 -6.97394,6.97393 -3.85165,0 -6.97394,-3.12228 -6.97394,-6.97393 0,-3.85164 3.12229,-6.97394 6.97394,-6.97394 3.85166,0 6.97394,3.1223 6.97394,6.97394 z" /></g><g                 transform="translate(141.732,35.433)"                 id="g126"><g                   id="g128" /><g                   transform="translate(-141.732,-35.433)"                   id="g130" /></g></g><g               id="g132"><g                 id="g134"><path                   id="path136"                   style="fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:#ffffff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                   d="m 148.70798,70.867 c 0,3.85166 -3.12228,6.97394 -6.97394,6.97394 -3.85165,0 -6.97394,-3.12228 -6.97394,-6.97394 0,-3.85163 3.12229,-6.97393 6.97394,-6.97393 3.85166,0 6.97394,3.1223 6.97394,6.97393 z" /></g><g                 transform="translate(141.732,70.866)"                 id="g138"><g                   id="g140" /><g                   transform="translate(-141.732,-70.866)"                   id="g142" /></g></g></g><g             id="g144"><g               id="g146"><g                 id="g148" /><g                 transform="translate(-9.222,28.989)"                 id="g150"><g                   id="g152"><g                     transform="translate(-80.945,-61.998)"                     id="g154"><text                       id="text158"                       style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMR10;-inkscape-font-specification:CMR10;writing-mode:lr-tb;fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,80.945,61.998)"><tspan                         id="tspan156"                         y="0"                         x="0">Θ</tspan></text><text                       id="text164"                       style="font-variant:normal;font-weight:normal;font-size:6.97380018px;font-family:CMR7;-inkscape-font-specification:CMR7;writing-mode:lr-tb;fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,88.694,67.173)"><tspan                         id="tspan160"                         y="0"                         x="0 3.1131043 7.0846834">(3)</tspan><tspan                         id="tspan162"                         y="7.8319998"                         x="0">1</tspan></text><g                       transform="translate(80.945,61.998)"                       id="g166" /></g></g><g                   transform="translate(9.222,-28.989)"                   id="g168" /></g></g><g               id="g170"><g                 id="g172" /><g                 transform="translate(-9.222,64.43)"                 id="g174"><g                   id="g176"><g                     transform="translate(-80.945,-97.439)"                     id="g178"><text                       id="text182"                       style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMR10;-inkscape-font-specification:CMR10;writing-mode:lr-tb;fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,80.945,97.439)"><tspan                         id="tspan180"                         y="0"                         x="0">Θ</tspan></text><text                       id="text188"                       style="font-variant:normal;font-weight:normal;font-size:6.97380018px;font-family:CMR7;-inkscape-font-specification:CMR7;writing-mode:lr-tb;fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,88.694,102.614)"><tspan                         id="tspan184"                         y="0"                         x="0 3.1131043 7.0846834">(3)</tspan><tspan                         id="tspan186"                         y="7.8309999"                         x="0">2</tspan></text><g                       transform="translate(80.945,97.439)"                       id="g190" /></g></g><g                   transform="translate(9.222,-64.43)"                   id="g192" /></g></g><g               id="g194"><g                 id="g196" /><g                 transform="translate(61.66,11.268)"                 id="g198"><g                   id="g200"><g                     transform="translate(-151.827,-44.277)"                     id="g202"><text                       id="text206"                       style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMR10;-inkscape-font-specification:CMR10;writing-mode:lr-tb;fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,151.827,44.277)"><tspan                         id="tspan204"                         y="0"                         x="0">Θ</tspan></text><text                       id="text212"                       style="font-variant:normal;font-weight:normal;font-size:6.97380018px;font-family:CMR7;-inkscape-font-specification:CMR7;writing-mode:lr-tb;fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,159.576,49.452)"><tspan                         id="tspan208"                         y="0"                         x="0 3.1131043 7.0846834">(2)</tspan><tspan                         id="tspan210"                         y="7.8309999"                         x="0">1</tspan></text><g                       transform="translate(151.827,44.277)"                       id="g214" /></g></g><g                   transform="translate(-61.66,-11.268)"                   id="g216" /></g></g><g               id="g218"><g                 id="g220" /><g                 transform="translate(61.66,46.71)"                 id="g222"><g                   id="g224"><g                     transform="translate(-151.827,-79.719)"                     id="g226"><text                       id="text230"                       style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMR10;-inkscape-font-specification:CMR10;writing-mode:lr-tb;fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,151.827,79.719)"><tspan                         id="tspan228"                         y="0"                         x="0">Θ</tspan></text><text                       id="text236"                       style="font-variant:normal;font-weight:normal;font-size:6.97380018px;font-family:CMR7;-inkscape-font-specification:CMR7;writing-mode:lr-tb;fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,159.576,84.894)"><tspan                         id="tspan232"                         y="0"                         x="0 3.1131043 7.0846834">(2)</tspan><tspan                         id="tspan234"                         y="7.8319998"                         x="0">2</tspan></text><g                       transform="translate(151.827,79.719)"                       id="g238" /></g></g><g                   transform="translate(-61.66,-46.71)"                   id="g240" /></g></g><g               id="g242"><g                 id="g244" /><g                 transform="translate(61.66,82.151)"                 id="g246"><g                   id="g248"><g                     transform="translate(-151.827,-115.16)"                     id="g250"><text                       id="text254"                       style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMR10;-inkscape-font-specification:CMR10;writing-mode:lr-tb;fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,151.827,115.16)"><tspan                         id="tspan252"                         y="0"                         x="0">Θ</tspan></text><text                       id="text260"                       style="font-variant:normal;font-weight:normal;font-size:6.97380018px;font-family:CMR7;-inkscape-font-specification:CMR7;writing-mode:lr-tb;fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,159.576,120.335)"><tspan                         id="tspan256"                         y="0"                         x="0 3.1131043 7.0846834">(2)</tspan><tspan                         id="tspan258"                         y="7.8319998"                         x="0">3</tspan></text><g                       transform="translate(151.827,115.16)"                       id="g262" /></g></g><g                   transform="translate(-61.66,-82.151)"                   id="g264" /></g></g><g               id="g266"><g                 id="g268" /><g                 transform="translate(132.543,11.268)"                 id="g270"><g                   id="g272"><g                     transform="translate(-222.71,-44.277)"                     id="g274"><text                       id="text278"                       style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMR10;-inkscape-font-specification:CMR10;writing-mode:lr-tb;fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,222.71,44.277)"><tspan                         id="tspan276"                         y="0"                         x="0">Θ</tspan></text><text                       id="text284"                       style="font-variant:normal;font-weight:normal;font-size:6.97380018px;font-family:CMR7;-inkscape-font-specification:CMR7;writing-mode:lr-tb;fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,230.459,49.452)"><tspan                         id="tspan280"                         y="0"                         x="0 3.1131043 7.0846834">(1)</tspan><tspan                         id="tspan282"                         y="7.8309999"                         x="0">1</tspan></text><g                       transform="translate(222.71,44.277)"                       id="g286" /></g></g><g                   transform="translate(-132.543,-11.268)"                   id="g288" /></g></g><g               id="g290"><g                 id="g292" /><g                 transform="translate(132.543,46.71)"                 id="g294"><g                   id="g296"><g                     transform="translate(-222.71,-79.719)"                     id="g298"><text                       id="text302"                       style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMR10;-inkscape-font-specification:CMR10;writing-mode:lr-tb;fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,222.71,79.719)"><tspan                         id="tspan300"                         y="0"                         x="0">Θ</tspan></text><text                       id="text308"                       style="font-variant:normal;font-weight:normal;font-size:6.97380018px;font-family:CMR7;-inkscape-font-specification:CMR7;writing-mode:lr-tb;fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,230.459,84.894)"><tspan                         id="tspan304"                         y="0"                         x="0 3.1131043 7.0846834">(1)</tspan><tspan                         id="tspan306"                         y="7.8319998"                         x="0">2</tspan></text><g                       transform="translate(222.71,79.719)"                       id="g310" /></g></g><g                   transform="translate(-132.543,-46.71)"                   id="g312" /></g></g><g               id="g314"><g                 id="g316" /><g                 transform="translate(132.543,82.151)"                 id="g318"><g                   id="g320"><g                     transform="translate(-222.71,-115.16)"                     id="g322"><text                       id="text326"                       style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMR10;-inkscape-font-specification:CMR10;writing-mode:lr-tb;fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,222.71,115.16)"><tspan                         id="tspan324"                         y="0"                         x="0">Θ</tspan></text><text                       id="text332"                       style="font-variant:normal;font-weight:normal;font-size:6.97380018px;font-family:CMR7;-inkscape-font-specification:CMR7;writing-mode:lr-tb;fill:#595959;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,230.459,120.335)"><tspan                         id="tspan328"                         y="0"                         x="0 3.1131043 7.0846834">(1)</tspan><tspan                         id="tspan330"                         y="7.8319998"                         x="0">3</tspan></text><g                       transform="translate(222.71,115.16)"                       id="g334" /></g></g><g                   transform="translate(-132.543,-82.151)"                   id="g336" /></g></g></g><g             id="g338"><g               id="g340"><path                 id="path342"                 style="fill:none;stroke:#48bbff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="M 7.7341,15.78816 63.1497,1.93376" /></g><g               id="g344"><path                 id="path346"                 style="fill:none;stroke:#48bbff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="M 7.73373,19.65474 63.14934,33.50893" /></g><g               id="g348"><path                 id="path350"                 style="fill:none;stroke:#48bbff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="M 6.3773,22.50426 64.5058,66.10057" /></g><g               id="g352"><path                 id="path354"                 style="fill:none;stroke:#48bbff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="M 6.37814,48.3804 64.50655,4.78375" /></g><g               id="g356"><path                 id="path358"                 style="fill:none;stroke:#48bbff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="M 7.73434,51.23076 63.14984,37.37624" /></g><g               id="g360"><path                 id="path362"                 style="fill:none;stroke:#48bbff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="M 7.73349,55.09746 63.14925,68.95152" /></g><g               id="g364"><path                 id="path366"                 style="fill:none;stroke:#48bbff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="m 78.85556,0 h 54.93938" /></g><g               id="g368"><path                 id="path370"                 style="fill:none;stroke:#48bbff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="m 78.0139,3.56415 56.62341,28.31193" /></g><g               id="g372"><path                 id="path374"                 style="fill:none;stroke:#48bbff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="M 76.52121,5.63612 136.13075,65.2459" /></g><g               id="g376"><path                 id="path378"                 style="fill:none;stroke:#48bbff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="M 78.01427,31.87851 134.6377,3.56633" /></g><g               id="g380"><path                 id="path382"                 style="fill:none;stroke:#48bbff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="m 78.85544,35.44281 54.93963,-2.3e-4" /></g><g               id="g384"><path                 id="path386"                 style="fill:none;stroke:#48bbff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="m 78.0134,39.00662 56.62368,28.31195" /></g><g               id="g388"><path                 id="path390"                 style="fill:none;stroke:#48bbff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="M 76.52193,65.24806 136.13136,5.6382" /></g><g               id="g392"><path                 id="path394"                 style="fill:none;stroke:#48bbff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="M 78.01476,67.32101 134.63792,39.0087" /></g><g               id="g396"><path                 id="path398"                 style="fill:none;stroke:#48bbff;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="m 78.85544,70.88568 54.93963,-3.7e-4" /></g></g><g             id="g400"><g               id="g402"><path                 id="path404"                 style="fill:none;stroke:#cccccc;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="M -51.37822,30.5678 -7.73373,19.6546" /></g><g               id="g406"><path                 id="path408"                 style="fill:none;stroke:#cccccc;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="M -51.37822,40.3213 -7.73424,51.23053" /></g><g               id="g410"><path                 id="path412"                 style="fill:none;stroke:#cccccc;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="m 149.73907,0 h 14.18645" /><g                 transform="translate(163.92552)"                 id="g414"><g                   id="g416"><path                     id="path418"                     style="fill:#cccccc;fill-opacity:1;fill-rule:nonzero;stroke:none"                     d="M 4.38364,0 -2.63017,3.50691 0,0 -2.63017,-3.50691" /></g></g></g><g               id="g420"><path                 id="path422"                 style="fill:none;stroke:#cccccc;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="m 149.73907,35.44173 14.18653,-0.0064" /><g                 transform="matrix(0.99998,-4.3e-4,4.3e-4,0.99998,163.9256,35.43538)"                 id="g424"><g                   id="g426"><path                     id="path428"                     style="fill:#cccccc;fill-opacity:1;fill-rule:nonzero;stroke:none"                     d="M 4.38364,0 -2.63017,3.50691 0,0 -2.63017,-3.50691" /></g></g></g><g               id="g430"><path                 id="path432"                 style="fill:none;stroke:#cccccc;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                 d="m 149.73907,70.88348 14.18653,-0.0126" /><g                 transform="matrix(0.99998,-8.9e-4,8.9e-4,0.99998,163.9256,70.87088)"                 id="g434"><g                   id="g436"><path                     id="path438"                     style="fill:#cccccc;fill-opacity:1;fill-rule:nonzero;stroke:none"                     d="M 4.38364,0 -2.63017,3.50691 0,0 -2.63017,-3.50691" /></g></g></g></g><g             id="g440"><g               id="g442"><g                 transform="translate(-75.417,-27.973)"                 id="g444"><g                   id="g446"><g                     transform="translate(-14.75,-5.036)"                     id="g448"><text                       id="text452"                       style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMMI10;-inkscape-font-specification:CMMI10;writing-mode:lr-tb;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,14.75,5.036)"><tspan                         id="tspan450"                         y="0"                         x="0">z</tspan></text><text                       id="text456"                       style="font-variant:normal;font-weight:normal;font-size:6.97380018px;font-family:CMR7;-inkscape-font-specification:CMR7;writing-mode:lr-tb;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,19.383,3.542)"><tspan                         id="tspan454"                         y="0"                         x="0">4</tspan></text><g                       transform="translate(14.75,5.036)"                       id="g458" /></g></g><g                   transform="translate(75.417,27.973)"                   id="g460" /></g></g><g               id="g462"><g                 transform="translate(-4.551,-27.973)"                 id="g464"><g                   id="g466"><g                     transform="translate(-85.616,-5.036)"                     id="g468"><text                       id="text472"                       style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMMI10;-inkscape-font-specification:CMMI10;writing-mode:lr-tb;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,85.616,5.036)"><tspan                         id="tspan470"                         y="0"                         x="0">z</tspan></text><text                       id="text476"                       style="font-variant:normal;font-weight:normal;font-size:6.97380018px;font-family:CMR7;-inkscape-font-specification:CMR7;writing-mode:lr-tb;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,90.249,3.542)"><tspan                         id="tspan474"                         y="0"                         x="0">3</tspan></text><g                       transform="translate(85.616,5.036)"                       id="g478" /></g></g><g                   transform="translate(4.551,27.973)"                   id="g480" /></g></g><g               id="g482"><g                 transform="translate(66.315,-27.973)"                 id="g484"><g                   id="g486"><g                     transform="translate(-156.482,-5.036)"                     id="g488"><text                       id="text492"                       style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMMI10;-inkscape-font-specification:CMMI10;writing-mode:lr-tb;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,156.482,5.036)"><tspan                         id="tspan490"                         y="0"                         x="0">z</tspan></text><text                       id="text496"                       style="font-variant:normal;font-weight:normal;font-size:6.97380018px;font-family:CMR7;-inkscape-font-specification:CMR7;writing-mode:lr-tb;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,161.115,3.542)"><tspan                         id="tspan494"                         y="0"                         x="0">2</tspan></text><g                       transform="translate(156.482,5.036)"                       id="g498" /></g></g><g                   transform="translate(-66.315,27.973)"                   id="g500" /></g></g><g               id="g502"><g                 transform="translate(136.777,-27.751)"                 id="g504"><g                   id="g506"><g                     transform="translate(-226.944,-5.258)"                     id="g508"><text                       id="text512"                       style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMMI10;-inkscape-font-specification:CMMI10;writing-mode:lr-tb;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,226.944,5.258)"><tspan                         id="tspan510"                         y="0"                         x="0">z</tspan></text><text                       id="text516"                       style="font-variant:normal;font-weight:normal;font-size:6.97380018px;font-family:CMR7;-inkscape-font-specification:CMR7;writing-mode:lr-tb;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,231.577,3.763)"><tspan                         id="tspan514"                         y="0"                         x="0">1</tspan></text><text                       id="text520"                       style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMR10;-inkscape-font-specification:CMR10;writing-mode:lr-tb;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,238.814,5.258)"><tspan                         id="tspan518"                         y="0"                         x="0">=</tspan></text><text                       id="text524"                       style="font-variant:normal;font-weight:normal;font-size:9.96259975px;font-family:CMMI10;-inkscape-font-specification:CMMI10;writing-mode:lr-tb;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none"                       transform="matrix(1,0,0,-1,249.33,5.258)"><tspan                         id="tspan522"                         y="0"                         x="0">y</tspan></text><g                       transform="translate(226.944,5.258)"                       id="g526" /></g></g><g                   transform="translate(-136.777,27.751)"                   id="g528" /></g></g><g               id="g530"><g                 id="g532"><path                   id="path534"                   style="fill:none;stroke:#000000;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                   d="m -53.15024,-26.57512 h 31.04987" /><g                   transform="translate(-22.10037,-26.57512)"                   id="g536"><g                     id="g538"><path                       id="path540"                       style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none"                       d="M 4.38364,0 -2.63017,3.50691 0,0 -2.63017,-3.50691" /></g></g></g><g                 id="g542"><path                   id="path544"                   style="fill:none;stroke:#000000;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                   d="M 17.71672,-26.57512 H 48.7666" /><g                   transform="translate(48.7666,-26.57512)"                   id="g546"><g                     id="g548"><path                       id="path550"                       style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none"                       d="M 4.38364,0 -2.63017,3.50691 0,0 -2.63017,-3.50691" /></g></g></g><g                 id="g552"><path                   id="path554"                   style="fill:none;stroke:#000000;stroke-width:1.99255002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"                   d="m 88.58376,-26.57512 h 31.04988" /><g                   transform="translate(119.63364,-26.57512)"                   id="g556"><g                     id="g558"><path                       id="path560"                       style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none"                       d="M 4.38364,0 -2.63017,3.50691 0,0 -2.63017,-3.50691" /></g></g></g></g></g></g></g></g></g></svg>
where `y` is the output and `z` represent variables on different layers.

The most important parameters are: 
* `layer_sizes` - these are the sizes of layers. The first layer will be used for clusterization
and therefore its size should correspond to the desired number of clusters.
* `layer_dims` - the input dimensions of each layer. Each layer has an input and output dimension. 
The output of the first layer is automatically set to the dimensionality of the data, and output of prevous layer
is considered the input of the next one. By reducing dimensionality of the deeper layers have fewer parameters,
and each layer becomes similar to Mixtures of Factor Analyzers. You would probably want to set the 
dimensions in a non-increasing order.
* `init` - determines how the model is initialized. Use `kmeans` (default) for initialization by `K-Means` and 
factor analysis on each layer. Use `random` for a completely random initialization.



### Deep Gaussian Mixture Model

DGMM is based on papers ["Deep Gaussian mixture models"](https://link.springer.com/article/10.1007/s11222-017-9793-z) 
by Cinzia Viroli, Geoffrey J. McLachlan (2019) and
["Factoring Variations in Natural Images with Deep Gaussian Mixture Models"](https://proceedings.neurips.cc/paper/2014/hash/8c3039bd5842dca3d944faab91447818-Abstract.html)
by Aaron van den Oord, Benjamin Schrauwen (2014).

The parameters are similar to GMN model, as is the implementation in this repository.

The difference between DGMM and GMN is that GMN gives probabilities to layer's components conditional
on the previous layer, while DGMM has them independent.

### Annealing

We implemented deterministic annealing for mixture models as described in the paper
["On the Bumpy Road to the Dominant Mode"](https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1467-9469.2009.00681.x?casa_token=ntehyQT23A0AAAAA:pHs1_s24ZAQvg36cwjxJTcAqgH4QW-VHwOq2p-wyHNCNSeymbOR9xEdp30sfbmjI-jxdeqrvaWr6mr8)
by Hua Zhou, Kenneth L. Lange (2010).

Since the log-likelihood functions is frequently non-concave, the EM algorithm can end up
in suboptimal modes. The idea of annealing is to flatten the objective function and therefore 
increase the chances of terminating in a dominant mode. 

The parameter `use_annealing` determines whether to use annealing, while the parameter 
`annealing_start_v` determines the intial value for annealing. The value must be between `0` and `1`.
Lower values correspond to a more flattened objective function, while `1` corresponds to no
annealing. Starting for the `annealing_start_v`, the annealing value will be increased to `1` during model fitting
if `use_annealing` is set to true.

### Regularizatoin

GMM, GMN and DGMM models have the variance regularization parameter `var_regularization`. 
Regularization makes the covariances larger on each step. This keeps the covariance matrix from becoming
close to singular, which would greatly degrade optimization for it. The parameter can also be used
for restricting the model to larger covariances and avoid overfitting.

## Stopping criterion

Use the `stopping_criterion` parameter in models to specify a stopping criterion. Specified function
must have the same signature as functions in the [mixes/stopping_criterion.py](mixes/stopping_criterion.py) file.

